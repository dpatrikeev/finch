---
alwaysApply: true
---

–ü–æ–º–Ω–∏: —á–µ–º –º–µ–Ω—å—à–µ –∏ –ø—Ä–æ—â–µ –∫–æ–¥, —Ç–µ–º –º–µ–Ω—å—à–µ –±–∞–≥–æ–≤. 

# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è Finch v2.0 - Remote Functions

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–° –ø–µ—Ä–µ—Ö–æ–¥–æ–º –Ω–∞ **Remote Functions** –≤ SvelteKit –º—ã –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞:

- ‚ùå –£–±–∏—Ä–∞–µ–º `api/` –ø–∞–ø–∫–∏ –≤ —Ñ–∏—á–∞—Ö
- ‚ùå –£–±–∏—Ä–∞–µ–º –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ `+page.server.ts` —Ñ–∞–π–ª–æ–≤  
- ‚ùå –£–±–∏—Ä–∞–µ–º stores –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –î–æ–±–∞–≤–ª—è–µ–º `data.remote.ts` –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º `await` expressions –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- ‚úÖ –ü–æ–ª—É—á–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∏—á–∏ (v2.0)

```text
src/lib/features/[feature-name]/
‚îú‚îÄ‚îÄ data.remote.ts              # ‚ú® –í–°–ï —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (queries, commands, forms)
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ index.ts                # –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ # –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îî‚îÄ‚îÄ [feature].types.ts      # TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ [feature].utils.ts      # –£—Ç–∏–ª–∏—Ç—ã (—á–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏)
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ [feature].utils.test.ts # –¢–µ—Å—Ç—ã —É—Ç–∏–ª–∏—Ç
‚îÇ   ‚îî‚îÄ‚îÄ [feature].remote.test.ts # ‚ú® –¢–µ—Å—Ç—ã remote functions
‚îú‚îÄ‚îÄ [Feature].svelte            # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å –ø—Ä—è–º—ã–º –¥–æ—Å—Ç—É–ø–æ–º –∫ –¥–∞–Ω–Ω—ã–º
‚îú‚îÄ‚îÄ index.ts                    # –ü—É–±–ª–∏—á–Ω—ã–π API (–≤–∫–ª—é—á–∞—è data.remote)
‚îî‚îÄ‚îÄ README.md                   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –ß—Ç–æ —É–±—Ä–∞–Ω–æ –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:
- ‚ùå `api/` –ø–∞–ø–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é
- ‚ùå `stores/` –ø–∞–ø–∫–∞ (–∑–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞ reactive queries)

## –ü—Ä–∞–≤–∏–ª–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. data.remote.ts - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä–≤–µ—Ä–æ–º

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞:**

```typescript
import { query, command, form } from '$app/server';
import { getRequestEvent } from '$app/server';
import * as v from 'valibot'; // –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

// ‚úÖ Queries - –¥–ª—è —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
export const getData = query(async (): Promise<DataType[]> => {
  const { locals } = getRequestEvent();
  // –ª–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
  return data;
});

export const getDataById = query(
  v.string(), // –≤–∞–ª–∏–¥–∞—Ü–∏—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞
  async (id: string): Promise<DataType | null> => {
    const { locals } = getRequestEvent();
    // –ª–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ ID
    return data;
  }
);

// ‚úÖ Commands - –¥–ª—è –º—É—Ç–∞—Ü–∏–π –±–µ–∑ —Ñ–æ—Ä–º
export const updateData = command(
  v.object({
    id: v.pipe(v.string(), v.minLength(1, 'ID –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω')),
    title: v.pipe(v.string(), v.minLength(1, '–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ'), v.maxLength(100, '–°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ'))
  }),
  async ({ id, title }) => {
    const { locals } = getRequestEvent();
    // –ª–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ queries
    await getData().refresh();
    
    return { success: true, message: '–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã' };
  }
);

// ‚úÖ Forms - –¥–ª—è HTML —Ñ–æ—Ä–º (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
export const createData = form(async (data) => {
  const { locals } = getRequestEvent();
  const title = data.get('title');
  // –ª–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è
  return { success: true };
});
```

### 2. –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å –ø—Ä—è–º—ã–º –¥–æ—Å—Ç—É–ø–æ–º –∫ –¥–∞–Ω–Ω—ã–º

```svelte
<script lang="ts">
  import { getData, updateData } from './data.remote';
  import { Component1, Component2 } from './components';
  
  // ‚úÖ –ü—Ä—è–º–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
  const data = $derived(await getData());
  
  // ‚úÖ –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º—É—Ç–∞—Ü–∏–π
  async function handleUpdate(newData) {
    try {
      await updateData(newData);
      // getData –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç—Å—è –±–ª–∞–≥–æ–¥–∞—Ä—è refresh()
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', error);
    }
  }
</script>

{#each data as item}
  <Component1 {item} onUpdate={handleUpdate} />
{/each}
```

### 3. –°—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞–∫ —Ç–æ–Ω–∫–∞—è –æ–±–µ—Ä—Ç–∫–∞

```svelte
<script lang="ts">
  import { Feature } from '$lib/features/feature-name';
</script>

<svelte:head>
  <title>–°—Ç—Ä–∞–Ω–∏—Ü–∞ - Finch</title>
</svelte:head>

<!-- ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è await expressions -->
<svelte:boundary>
  <section class="mx-auto p-5 md:p-10">
    <h1>–ó–∞–≥–æ–ª–æ–≤–æ–∫</h1>
    <Feature />
  </section>
  
  {#snippet pending()}
    <div class="flex justify-center py-8">
      <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
    </div>
  {/snippet}
</svelte:boundary>
```

### 4. –í–∞–ª–∏–¥–∞—Ü–∏—è —Å valibot

```typescript
import * as v from 'valibot';

// ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ —Ç–∏–ø—ã
export const getUser = query(
  v.string(), 
  async (userId: string) => { /* ... */ }
);

// ‚úÖ –°–ª–æ–∂–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã
export const createPost = command(
  v.object({
    title: v.pipe(v.string(), v.minLength(1), v.maxLength(100)),
    content: v.string(),
    tags: v.array(v.string()),
    publishedAt: v.optional(v.date())
  }),
  async (data) => { /* ... */ }
);

// ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 'unchecked' –±–µ–∑ –≤–µ—Å–∫–æ–π –ø—Ä–∏—á–∏–Ω—ã
export const unsafeFunction = command(
  'unchecked', // –¢–æ–ª—å–∫–æ –≤ –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞—è—Ö!
  async (data) => { /* ... */ }
);
```

### 5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```typescript
// ‚úÖ –í remote function - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
export const createItem = command(
  v.object({ title: v.string() }),
  async (data) => {
    const result = await db.create(data);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ queries
    await getItems().refresh();
    
    return result;
  }
);

// ‚úÖ –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ - —Ä—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
async function handleCreate(data) {
  await createItem(data);
  // getItems() –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç—Å—è
}

// ‚úÖ –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
async function optimisticUpdate(newItem) {
  try {
    await createItem(newItem);
  } catch (error) {
    // –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    toast.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞');
  }
}
```

### 6. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```typescript
// ‚úÖ –í remote functions
export const riskyOperation = command(
  v.string(),
  async (id: string) => {
    try {
      const result = await someRiskyOperation(id);
      return { success: true, data: result };
    } catch (error) {
      // –õ–æ–≥–∏—Ä—É–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
      console.error('–û—à–∏–±–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏:', error);
      // –ë—Ä–æ—Å–∞–µ–º –ø–æ–Ω—è—Ç–Ω—É—é –æ—à–∏–±–∫—É –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞
      throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é');
    }
  }
);

// ‚úÖ –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
async function handleRiskyAction() {
  try {
    await riskyOperation(itemId);
    toast.success('–û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
  } catch (error) {
    const message = error instanceof Error ? error.message : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';
    toast.error(message);
  }
}
```

## –ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–ª–∞–Ω

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (‚úÖ –ì–æ—Ç–æ–≤–æ)
- [x] `remoteFunctions: true` –≤ svelte.config.js
- [x] `async: true` –≤ compilerOptions  
- [x] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å valibot: `bun add valibot`

### –≠—Ç–∞–ø 2: –ú–∏–≥—Ä–∞—Ü–∏—è —Ñ–∏—á (–æ–¥–Ω–∞ –∑–∞ —Ä–∞–∑)
1. ‚úÖ **Students** - –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞
2. [ ] **Homework** - —Å–ª–µ–¥—É—é—â–∞—è
3. [ ] **Exercises** 
4. [ ] **Quiz**
5. [ ] **Notation**

### –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –æ–¥–Ω–æ–π —Ñ–∏—á–∏:
1. –°–æ–∑–¥–∞—Ç—å `data.remote.ts`
2. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É –∏–∑ `api/queries.ts` ‚Üí queries –≤ remote
3. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É –∏–∑ `api/actions.ts` ‚Üí commands –≤ remote  
4. –û–±–Ω–æ–≤–∏—Ç—å –≥–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–∏—á–∏
5. –£–ø—Ä–æ—Å—Ç–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã (—É–±—Ä–∞—Ç—å `+page.server.ts`)
6. –£–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É `api/`
7. –û–±–Ω–æ–≤–∏—Ç—å `index.ts` —Ñ–∏—á–∏
8. –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã

### –≠—Ç–∞–ø 3: –û—á–∏—Å—Ç–∫–∞
- –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ `+page.server.ts`
- –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Ñ–∏—á
- –û–±–Ω–æ–≤–∏—Ç—å README –ø—Ä–æ–µ–∫—Ç–∞

## –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### –î–æ (—Å—Ç–∞—Ä–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞):
```text
–¶–µ–ø–æ—á–∫–∞: +page.server.ts ‚Üí api/queries.ts ‚Üí +page.svelte ‚Üí Feature.svelte
```

```typescript
// src/routes/students/+page.server.ts
export const load = async ({ locals }) => {
  const students = await loadTeacherStudents(locals);
  return { students };
};

// src/routes/students/+page.svelte  
let { data } = $props();
<Students students={data.students} />

// src/lib/features/students/Students.svelte
const { students } = $props();
```

### –ü–æ—Å–ª–µ (Remote Functions):
```text
–¶–µ–ø–æ—á–∫–∞: Feature.svelte ‚Üí data.remote.ts
```

```typescript
// src/lib/features/students/data.remote.ts
export const getTeacherStudents = query(async () => {
  const { locals } = getRequestEvent();
  // –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
  return students;
});

// src/routes/students/+page.svelte (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è)
<svelte:boundary>
  <Students />
  {#snippet pending()}<div>–ó–∞–≥—Ä—É–∑–∫–∞...</div>{/snippet}
</svelte:boundary>

// src/lib/features/students/Students.svelte
const students = $derived(await getTeacherStudents());
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ:
- **-40% —Ñ–∞–π–ª–æ–≤** –≤ –∫–∞–∂–¥–æ–π —Ñ–∏—á–µ
- **-60% —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞** –≤ –º–∞—Ä—à—Ä—É—Ç–∞—Ö  
- **-100% –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** —Ç–∏–ø–æ–≤ –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–æ–º –∏ –∫–ª–∏–µ–Ω—Ç–æ–º

### –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ:
- **–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º** –∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** –±–µ–∑ stores
- **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏–∑ –∫–æ—Ä–æ–±–∫–∏**
- **–ú–µ–Ω—å—à–µ –±–æ–π–ª–µ—Ä–ø–ª–µ–π—Ç–∞**
- **–ü—Ä–æ—â–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

## –ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

**‚ùå –ù–ï –î–ï–õ–ê–¢–¨:**

1. **–°–º–µ—à–∏–≤–∞–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤:**
```typescript
// –ü–õ–û–•–û - –Ω–µ —Å–º–µ—à–∏–≤–∞–π load functions –∏ remote functions
export const load = async ({ locals }) => {
  const data = await someRemoteFunction(); // –ù–ï–¢!
};
```

2. **–°–æ—Å—Ç–æ—è–Ω–∏–µ –≤ remote functions:**
```typescript
// –ü–õ–û–•–û - remote functions stateless
let cache = new Map();
export const getData = query(async () => {
  if (cache.has('key')) return cache.get('key'); // –ù–ï–¢!
});
```

3. **–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
```typescript
// –ü–õ–û–•–û - –≤—Å–µ–≥–¥–∞ –≤–∞–ª–∏–¥–∏—Ä—É–π
export const updateUser = command('unchecked', async (data) => {
  // –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ!
});
```

4. **–ó–∞–±—ã–≤–∞–Ω–∏–µ –ø—Ä–æ svelte:boundary:**
```svelte
<!-- –ü–õ–û–•–û - await –±–µ–∑ boundary -->
<div>
  {#each await getData() as item}
    <div>{item.name}</div>
  {/each}
</div>
```

5. **–ù–µ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ queries:**
```typescript
// –ü–õ–û–•–û - –¥–∞–Ω–Ω—ã–µ –Ω–µ –æ–±–Ω–æ–≤—è—Ç—Å—è
export const createItem = command(v.object({}), async (data) => {
  await db.create(data);
  // –ó–∞–±—ã–ª–∏: await getItems().refresh();
  return { success: true };
});
```

6. **–ò–∑–±—ã—Ç–æ—á–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã –∏ —Ç–µ—Å—Ç—ã:**
```typescript
// ‚ùå –ü–õ–û–•–û - —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
export function formatName(first: string, last: string) {
  return `${first} ${last}`; // –õ—É—á—à–µ –∏–Ω–ª–∞–π–Ω –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
}

// ‚ùå –ü–õ–û–•–û - —Ö—Ä—É–ø–∫–∏–µ —Ç–µ—Å—Ç—ã CSS –∫–ª–∞—Å—Å–æ–≤
expect(getAccuracyColor(85)).toBe('bg-green-500'); // –°–ª–æ–º–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–∏–∑–∞–π–Ω–∞

// ‚úÖ –•–û–†–û–®–û - –∫—Ä–∏—Ç–∏—á–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
export function calculateStudentsStats(students, totalExercises) {
  // –°–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è - –Ω—É–∂–Ω—ã —Ç–µ—Å—Ç—ã
}
```

## –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è —É—Ç–∏–ª–∏—Ç –∏ —Ç–µ—Å—Ç–æ–≤

### ‚úÖ –°–û–ó–î–ê–í–ê–¢–¨ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è:

1. **–ö—Ä–∏—Ç–∏—á–Ω–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏:**
   - –°–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –ø—Ä–æ—Ü–µ–Ω—Ç—ã)
   - –ê–ª–≥–æ—Ä–∏—Ç–º—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

2. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –ª–æ–≥–∏–∫–∏:**
   - –§—É–Ω–∫—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ 3+ –º–µ—Å—Ç–∞—Ö
   - –°–ª–æ–∂–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### ‚ùå –ù–ï –°–û–ó–î–ê–í–ê–¢–¨ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è:

1. **–ü—Ä–æ—Å—Ç–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
2. **CSS –∫–ª–∞—Å—Å–æ–≤ –∏ —Å—Ç–∏–ª–µ–π:**
3. **–û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–π –ª–æ–≥–∏–∫–∏:**
   - –§—É–Ω–∫—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
   - –¢—Ä–∏–≤–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

### ‚úÖ –ü–ò–°–ê–¢–¨ —Ç–µ—Å—Ç—ã –¥–ª—è:

1. **–ö—Ä–∏—Ç–∏—á–Ω–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏:**
   ```typescript
   // ‚úÖ –í–∞–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
   describe('calculateStudentsStats', () => {
     it('should calculate completion rate correctly', () => {
       expect(stats.completionRate).toBe(75);
     });
   });
   ```

2. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π:**
   ```typescript
   // ‚úÖ –ü–æ–∏—Å–∫ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤–ª–∏—è—é—Ç –Ω–∞ UX
   describe('filterStudents', () => {
     it('should find students by name', () => {
       expect(filtered).toHaveLength(2);
     });
   });
   ```

3. **–ì—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤:**
   ```typescript
   // ‚úÖ –í–∞–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å edge cases
   it('should handle empty input gracefully', () => {
     expect(calculateStats([])).toEqual({ total: 0, active: 0 });
   });
   ```

### ‚ùå –ù–ï –ü–ò–°–ê–¢–¨ —Ç–µ—Å—Ç—ã –¥–ª—è:

1. **CSS –∫–ª–∞—Å—Å–æ–≤:**
   ```typescript
   // ‚ùå –•—Ä—É–ø–∫–∏–µ, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ
   expect(getAccuracyColor(85)).toBe('bg-green-500');
   ```

2. **–ü—Ä–æ—Å—Ç–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
   ```typescript
   // ‚ùå –¢—Ä–∏–≤–∏–∞–ª—å–Ω–æ
   expect(formatInitials('John', 'Doe')).toBe('JD');
   ```

3. **–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:**
   ```typescript
   // ‚ùå –ú–µ—Ä—Ç–≤—ã–π –∫–æ–¥
   expect(isValidStudentInfo(student)).toBe(true);
   ```

### üéØ –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:

#### 1. "–ü—Ä–æ—Å—Ç–æ–µ - –ø—Ä—è–º–æ –≤ —Ä–∞–∑–º–µ—Ç–∫—É"

**–ü—Ä–∞–≤–∏–ª–æ:** –ï—Å–ª–∏ –ª–æ–≥–∏–∫–∞ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É - –ø–∏—à–∏ –ø—Ä—è–º–æ –≤ JSX/—Ä–∞–∑–º–µ—Ç–∫–µ

```svelte
<!-- ‚ùå –ò–∑–±—ã—Ç–æ—á–Ω–æ -->
<script>
  const fullName = (first, last) => [first, last].filter(Boolean).join(' ');
</script>
<h1>{fullName(student.firstName, student.lastName)}</h1>

<!-- ‚úÖ –ü—Ä–æ—â–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ -->
<h1>{[student.firstName, student.lastName].filter(Boolean).join(' ')}</h1>

<!-- ‚úÖ –ö–æ—Ä–æ—Ç–∫–∏–µ —É—Å–ª–æ–≤–∏—è -->
<div class="{accuracy > 80 ? 'text-green-600' : 'text-red-600'}">

<!-- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è -->
<span>{Math.round(progress * 100)}%</span>
```

**–ö–æ–≥–¥–∞ –≤—ã–Ω–æ—Å–∏—Ç—å –≤ —Ñ—É–Ω–∫—Ü–∏—é:**
- –õ–æ–≥–∏–∫–∞ —Å–ª–æ–∂–Ω–µ–µ 1 —Å—Ç—Ä–æ–∫–∏
- –ü–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è 3+ —Ä–∞–∑ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
- –ö—Ä–∏—Ç–∏—á–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

#### 2. "–¢–µ—Å—Ç–∏—Ä—É–π —Ü–µ–Ω–Ω–æ—Å—Ç—å, –Ω–µ –ø–æ–∫—Ä—ã—Ç–∏–µ"

**–•–æ—Ä–æ—à–∏–µ —Ç–µ—Å—Ç—ã:**
- –ó–∞—â–∏—â–∞—é—Ç –æ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –≤ –∫—Ä–∏—Ç–∏—á–Ω–æ–π –ª–æ–≥–∏–∫–µ
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É—é—Ç –æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- –ë—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã
- –õ–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

**–ü–ª–æ—Ö–∏–µ —Ç–µ—Å—Ç—ã:**
- –¢–µ—Å—Ç–∏—Ä—É—é—Ç —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É
- –õ–æ–º–∞—é—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∏–∑–∞–π–Ω–∞
- –î—É–±–ª–∏—Ä—É—é—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –¢–µ—Å—Ç–∏—Ä—É—é—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ remote functions:

```typescript
// src/lib/features/students/tests/students.remote.test.ts
import { describe, it, expect, vi } from 'vitest';
import { getTeacherStudents } from '../data.remote';

// –ú–æ–∫–∞–µ–º getRequestEvent
vi.mock('$app/server', () => ({
  getRequestEvent: () => ({
    locals: {
      auth: () => ({ userId: 'teacher-123' })
    }
  })
}));

describe('Students Remote Functions', () => {
  it('should load teacher students', async () => {
    const students = await getTeacherStudents();
    expect(students).toBeDefined();
    expect(Array.isArray(students)).toBe(true);
  });
});
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

```typescript
// –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å remote functions —Ç—Ä–µ–±—É—é—Ç –æ—Å–æ–±–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
// –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–∫–∏ –¥–ª—è remote functions
vi.mock('../data.remote', () => ({
  getTeacherStudents: vi.fn(() => Promise.resolve([]))
}));
```

### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç —É–ø—Ä–æ—â–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤:

**–î–æ (students feature):**
- 8 –≥—Ä—É–ø–ø —Ç–µ—Å—Ç–æ–≤ (270 —Å—Ç—Ä–æ–∫)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å CSS –∫–ª–∞—Å—Å—ã, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- 50% —Ç–µ—Å—Ç–æ–≤ –±—ã–ª–∏ –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã–º–∏

**–ü–æ—Å–ª–µ:**
- 4 –≥—Ä—É–ø–ø—ã —Ç–µ—Å—Ç–æ–≤ (~130 —Å—Ç—Ä–æ–∫)
- –¢–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- 100% –ø–æ–ª–µ–∑–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

**–í—ã–≥–æ–¥–∞:**
- ‚ö° **-50% –≤—Ä–µ–º–µ–Ω–∏** –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤
- üîß **-50% —É—Å–∏–ª–∏–π** –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ç–µ—Å—Ç–æ–≤
- üìà **+100% –∫–∞—á–µ—Å—Ç–≤–∞** –ø–æ–∫—Ä—ã—Ç–∏—è
- üéØ **–§–æ–∫—É—Å –Ω–∞ –≤–∞–∂–Ω–æ–º**, –∞ –Ω–µ –Ω–∞ –ø–æ–∫—Ä—ã—Ç–∏–∏

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Remote Functions –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞:

- **–ú–µ–Ω—å—à–µ —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫**
- **–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º**  
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**
- **–õ—É—á—à–∞—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
- **–ü—Ä–æ—â–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞**

–°–ª–µ–¥—É–π—Ç–µ —ç—Ç–∏–º –ø—Ä–∞–≤–∏–ª–∞–º –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ñ–∏—á –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö.
